---
layout: post
title: "倒排与列存"
date: 2017-02-12 22:28:05 +0800
comments: true
categories: 搜索引擎
---
## 倒排与列存

+ 一直傻傻分不清倒排和列存，今天有空梳理一下，主要有三个概念要明确:
  1. 索引方式: 正向索引，反向索引(倒排)
  2. 数据结构: HashMap,B-Tree,BitMap...
  3. 存储方式: 行存，列存
<!--more-->
### 倒排索引 Inverted Index
![倒排索引](https://zos.alipayobjects.com/rmsportal/NuEcaaUjQpwwOEArXoID.png)
+ 倒排索引是信息检索中最基础的索引方法，和正向索引相对，具体是把索引存为倒排表和倒排链，倒排表存的是所有的值，倒排链存的是 DocId 列表。__倒排索引是一种从 value->key 的索引方法__
+ 显然，这种数据结构极其适合快速精确查询。

#### 倒排索引与B-Tree
+ 倒排索引只是种索引方法，而具体实现需要用数据结构来实现
+ B 树就是一种常见的实现倒排字典的数据结构，一般倒排字典还可以用 hash 表实现，而倒排链主要就是链表和 bitmap

### 列式存储 Column-based Storage
![行列比较](https://zos.alipayobjects.com/rmsportal/XkrgHfcfhjWJbRBVohTq.png)
+ 列式存储是一种文件存储方法，和行存相对
+ 列存是一种在磁盘上的实际存储方式，在只对单列查询的时候较行存能大大增加 I/O 效率和缓存命中率


#### 列存与行存
+ 列存和行存都是针对顺序存储的文件
+ 列存可以更方便的进行数据压缩，因为在一起的都是相同的数据类型
+ 行存的存储速度更快，因为写入一行只需一次写入，但是列存需要修改很多列

#### 存储方式与数据结构
+ 目前的行存数据库中都有 B 树，B 树持久化后和列存有什么区别？
+ 感觉数据结构和存储方式隐隐有些不同，具体周一咨询下其他同学
+ 基于行的数据结构，比较方便的是判断某一行某一个字段是否为空

#### 列存与倒排
+ 倒排和列存实际上不是同一层次的概念
+ 倒排天然是针对某一列的，所以必然是一种列存
+ 而列存不一定是倒排，主要要看具体存储的数据结构，可以是正向的直接存储，也可以是反向的倒排
+ 搜索引擎里的正排索引常常使用列存，因为往往需要排序的只有很少几列

### 参考资料
1.[几张图看懂列式存储](http://www.lai18.com/content/1702672.html)